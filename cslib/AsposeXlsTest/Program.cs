using System;
using System.IO;

namespace SpireXlsTest
{
    internal class Program
    {

        /// <summary>
        /// 激活Aspose
        /// </summary>
        //private static void ActiveAspose()
        //{
        //    string LData = "DQo8TGljZW5zZT4NCjxEYXRhPg0KPExpY2Vuc2VkVG8+VGhlIFdvcmxkIEJhbms8L0xpY2Vuc2VkVG8+DQo8RW1haWxUbz5ra3VtYXIzQHdvcmxkYmFua2dyb3VwLm9yZzwvRW1haWxUbz4NCjxMaWNlbnNlVHlwZT5EZXZlbG9wZXIgU21hbGwgQnVzaW5lc3M8L0xpY2Vuc2VUeXBlPg0KPExpY2Vuc2VOb3RlPjEgRGV2ZWxvcGVyIEFuZCAxIERlcGxveW1lbnQgTG9jYXRpb248L0xpY2Vuc2VOb3RlPg0KPE9yZGVySUQ+MjEwMzE2MTg1OTU3PC9PcmRlcklEPg0KPFVzZXJJRD43NDQ5MTY8L1VzZXJJRD4NCjxPRU0+VGhpcyBpcyBub3QgYSByZWRpc3RyaWJ1dGFibGUgbGljZW5zZTwvT0VNPg0KPFByb2R1Y3RzPg0KPFByb2R1Y3Q+QXNwb3NlLlRvdGFsIGZvciAuTkVUPC9Qcm9kdWN0Pg0KPC9Qcm9kdWN0cz4NCjxFZGl0aW9uVHlwZT5Qcm9mZXNzaW9uYWw8L0VkaXRpb25UeXBlPg0KPFNlcmlhbE51bWJlcj4wM2ZiMTk5YS01YzhhLTQ4ZGItOTkyZS1kMDg0ZmYwNjZkMGM8L1NlcmlhbE51bWJlcj4NCjxTdWJzY3JpcHRpb25FeHBpcnk+MjAyMjA1MTY8L1N1YnNjcmlwdGlvbkV4cGlyeT4NCjxMaWNlbnNlVmVyc2lvbj4zLjA8L0xpY2Vuc2VWZXJzaW9uPg0KPExpY2Vuc2VJbnN0cnVjdGlvbnM+aHR0cHM6Ly9wdXJjaGFzZS5hc3Bvc2UuY29tL3BvbGljaWVzL3VzZS1saWNlbnNlPC9MaWNlbnNlSW5zdHJ1Y3Rpb25zPg0KPC9EYXRhPg0KPFNpZ25hdHVyZT5XbkJYNnJOdHpCclNMV3pBdFlqOEtkdDFLSUI5MlFrL2xEbFNmMlM1TFRIWGdkcS9QQ2NqWHVORmp0NEJuRmZwNFZLc3VsSjhWeFExakIwbmM0R1lWcWZLek14SFFkaXFuZU03NTJaMjlPbmdyVW40Yk0rc1l6WWVSTE9UOEpxbE9RN05rRFU0bUk2Z1VyQ3dxcjdnUVYxbDJJWkJxNXMzTEFHMFRjQ1ZncEE9PC9TaWduYXR1cmU+DQo8L0xpY2Vuc2U+DQo=";

        //    MemoryStream stream3 = new MemoryStream(Convert.FromBase64String(LData));

        //    Aspose.Cells.License license3 = new Aspose.Cells.License();
        //    stream3.Seek(0, SeekOrigin.Begin);
        //    license3.SetLicense(stream3);
        //}

        //private static void ActiveAspose2()
        //{
        //    string LData = "Abz0QL5BfWxHfu4uvomXdNzOytoQLFkwaB4d6NONP84BAR/iUvebBzP2mFbJysxla0opoILKTrEAXtweDlI+9UYqrfofEsGuHSXRi/i/n2m2CDqAhtEdG7Uqzmtcy9aBe+xD5yMBpL9TwGNqa9BmeW2c4kXfYll77Hffqa0N9og=";

        //    MemoryStream stream3 = new MemoryStream(Convert.FromBase64String(LData));

        //    Aspose.Cells.License license3 = new Aspose.Cells.License();
        //    stream3.Seek(0, SeekOrigin.Begin);
        //    license3.SetLicense(stream3);
        //}

        public static void Main(string[] args)
        {
            //ActiveAspose();

            //string filePath = "D:/web/水科院文件/委托报告/混凝土工程类/混凝土制品/25000019/20250530140244_25000019.xls";
            //byte[] fileBytes = File.ReadAllBytes(filePath);
            //MemoryStream steam = new MemoryStream(fileBytes);

            ////Spire.Xls.Workbook workbook = new Spire.Xls.Workbook();
            ////workbook.LoadFromStream(steam);
            //////workbook.ConverterSetting.PdfSecurity.Encrypt("111111", "222222", PdfPermissionsFlags.Print, PdfEncryptionKeySize.Key128Bit);
            //string newFile = "D:\\" + DateTime.Now.ToString("yyyyMMddHHmmss") + ".pdf";
            ////workbook.SaveToFile(newFile, Spire.Xls.FileFormat.PDF);

            //// 加载Excel文件
            //Workbook workbook = new Workbook(filePath);

            //// 设置PDF保存选项
            //PdfSaveOptions saveOptions = new PdfSaveOptions();
            //saveOptions.OnePagePerSheet = true; // 设置每张工作表为一页

            //// 保存为PDF
            //workbook.Save(newFile, saveOptions);



            //// 转换为HTML
            //workbook.Save("D:\\output.html", SaveFormat.Html);


            //workbook.Dispose();

            //steam.Dispose();
        }
    }
}
